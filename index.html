<h1>バート語の組版</h1>

<svg id="main" height="60mm" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <g fill="none" stroke-opacity=".5">
        <g stroke-linecap="round" stroke-linejoin="round">
            <g stroke-width="15" id="glyphs_main">
            </g>
        </g>
        <g id="boxes" stroke="#540054" stroke-width="15">
        </g>
    </g>
</svg>

<script src="glyphs.js"></script>
<script src="main.js"></script>

<script>
    const GLOBAL_GLYPH_TABLE = {
        "pha": {
            width: 135,
            paths: automatic({ consonant: "p", vowel: "a", dotted: true })
        },
        "phá": {
            width: 135,
            paths: automatic({ consonant: "p", vowel: "á", dotted: true })
        },

        "phai": {
            width: 135,
            paths: automatic({ consonant: "p", vowel: "ai", dotted: true })
        },

        "za": {
            width: 135,
            paths: automatic({ consonant: "z", vowel: "a" })
        },
        "zá": {
            width: 135,
            paths: automatic({ consonant: "z", vowel: "á" })
        },
        "ze": {
            width: 135,
            paths: automatic({ consonant: "z", vowel: "e" })
        },
        "zai": {
            width: 135,
            paths: automatic({ consonant: "z", vowel: "ai" })
        },
        "gha": {
            width: 165,
            paths: automatic({ consonant: "g", vowel: "a", dotted: true })
        },
        "ghá": {
            width: 165,
            paths: automatic({ consonant: "g", vowel: "á", dotted: true })
        },

        "ghai": {
            width: 165,
            paths: automatic({ consonant: "g", vowel: "ai", dotted: true })
        },

        "ʔa": {
            width: 105,
            paths: automatic({ consonant: "ʔ", vowel: "a" })
        },

        "ʔá": {
            width: 105,
            paths: automatic({ consonant: "ʔ", vowel: "á" })
        },

        "ʔai": {
            width: 120,
            paths: automatic({ consonant: "ʔ", vowel: "ai" })
        },
        "khú": {
            width: 135,
            paths: automatic({ consonant: "k", vowel: "ú", dotted: true })
        },
        "wa": {
            width: 105,
            paths: automatic({ consonant: "w", vowel: "a" })
        },
        "dhe": {
            width: 105,
            paths: automatic({ consonant: "d", vowel: "e", dotted: true })
        },
        "ṣъ": {
            width: 105,
            paths: automatic({ consonant: "c", vowel: "ъ", dotted: true })
        },
        "he": {
            width: 105,
            paths: automatic({ consonant: "h", vowel: "e" })
        },
        "ma": {
            width: 135,
            paths: automatic({ consonant: "m", vowel: "a" })
        },
        "sá": {
            width: 105,
            paths: automatic({ consonant: "s", vowel: "á" })
        },
        "ṇau": {
            width: 165,
            paths: automatic({ consonant: "n", vowel: "au", dotted: true })
        },
        "ṭu": {
            width: 105,
            paths: automatic({ consonant: "t", vowel: "u", dotted: true })
        },
        "xaQ": {
            width: 135,
            paths: automatic({ consonant: "x", vowel: "aQ" })
        },
        "li": {
            width: 165, paths: automatic({ consonant: "l", vowel: "i" })
        },
        "bho": {
            width: 165, paths: automatic({ consonant: "b", vowel: "o", dotted: true })
        },
        "ḷo": {
            width: 165, paths: automatic({ consonant: "l", vowel: "o", dotted: true })
        },
        "rí": {
            width: 165, paths: automatic({ consonant: "r", vowel: "í" })
        },
        "ya": {
            width: 135, paths: automatic({ consonant: "j", vowel: "a", dotted: true })
        },
    };

    const text_to_render = [
        "xaQ",
        "li",
        "bho",
        "ḷo",
        "rí",
        "ya",
        /*"ze",
        "he",
        "ma",
        "sá",
        "ṇau",
        "ṭu",*/
        /* "ʔá",
         "ghai",
         "khú",
         "wa",
         "dhe",
         "ṣъ",*/
        /* "pha",
         "phá",
         "phe",
         "phai",
         "za",
         "zá",
         "ze",
         "zai",
         "gha",
         "ghá",
         "ghe",
         "ghai",
         "ʔa",
         "ʔá",
         "ʔe",
         "ʔai",*/
    ];

    const DEBUG_MODE = true;

    // 1 単位分、棒だけが描画される余白を残す
    let box_left_pos = UNIT;

    for (let i = 0; i < text_to_render.length; i++) {
        const current_glyph = GLOBAL_GLYPH_TABLE[text_to_render[i]] ?? (() => { throw new Error(`Unknown glyph: ${text_to_render[i]}`) })();

        if (DEBUG_MODE)
            document.getElementById("boxes").innerHTML += `<rect x="${box_left_pos + UNIT / 2}" y="${UNIT / 2}" width="${current_glyph.width}" height="${BOX_FULL_HEIGHT}" rx="0" ry="0" />`;

        let glyph = "";

        for (let j = 0; j < current_glyph.paths.length; j++) {
            glyph += current_glyph.paths[j];
        }

        document.getElementById("glyphs_main").innerHTML += `<g transform="translate(${box_left_pos})">${glyph}</g>`;

        box_left_pos += current_glyph.width;
    }

    if (DEBUG_MODE)
        document.getElementById("glyphs_main").innerHTML += `<path id="baseline" d="m7.5 229.86h${box_left_pos + UNIT}" stroke="#ffff00" />`;

    document.getElementById("glyphs_main").innerHTML += `<path id="nautuhoma_e" d="m7.5 86.366h${box_left_pos + UNIT}" stroke="#800000" />`;

    document.getElementById("main").setAttribute("viewBox", `0 0 ${box_left_pos + UNIT * 2} ${BOX_FULL_HEIGHT + UNIT}`);
</script>

<h1>作った組み合わせ一覧</h1>

<script>
    const list_of_defined = Object.keys(GLOBAL_GLYPH_TABLE);

    const list_of_consonants = ["ph", "m", "ṣ", "s", "z", "ṭ", "dh", "ṇ", "l", "ḷ", "r", "kh", "gh", "h", "w", "ʔ"];
    const list_of_vowels = ["a", "ъ", "á", "e", "i", "í", "u", "ú", "ai", "au"];

    // draw the HTML table
    document.write("<table border='1' cellpadding='5' cellspacing='0'>");
    document.write("<tr>");
    document.write("<td>↓C ＼ V→</td>");
    for (let i = 0; i < list_of_vowels.length; i++) {
        document.write(`<td>${list_of_vowels[i]}</td>`);
    }
    document.write("</tr>");

    for (let i = 0; i < list_of_consonants.length; i++) {
        document.write("<tr>");
        document.write(`<td>${list_of_consonants[i]}</td>`);
        for (let j = 0; j < list_of_vowels.length; j++) {
            const current_combination = list_of_consonants[i] + list_of_vowels[j];
            document.write(`<td>${list_of_defined.includes(current_combination) ? current_combination : ""}</td>`);
        }
        document.write("</tr>");
    }

</script>